@* a default display template for the TableOfContentsPart *@

@using CSM.Navigation.Settings
@using CSM.Navigation.ViewModels

@{
    TableOfContentsSettings settings = Model.ContentPart.Settings.GetModel<TableOfContentsSettings>();
    TableOfContentsPartViewModel viewModel = Model.ViewModel;
}

@if (viewModel.Generate)
{
    <nav id="@viewModel.ContainerId" class="toc">
    </nav>

    using (Script.Foot())
    {
        Script.Require("TableOfContents");
        Style.Require("TableOfContents");

        <script type="text/javascript">
            $(function() {
                var root = $("@Html.Raw(viewModel.RootSelector)");
                var startLevel = @viewModel.StartLevel;
                var endLevel = @viewModel.EndLevel;
                var navTarget = $("#@viewModel.ContainerId");
                var affix = "@viewModel.Affix".toLowerCase() === "true";
                var makeTopLink = "@viewModel.MakeTopLink".toLowerCase() === "true";
                var topLinkText = "@viewModel.TopLinkText";

                navTarget.tableOfContents({
                    container: root,
                    startLevel: startLevel,
                    endLevel: endLevel,
                    affix: affix,
                    makeTopLink: makeTopLink,
                    topLinkText: topLinkText,
                });
            });
        </script>
    }
}
